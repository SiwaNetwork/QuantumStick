ASIX USB3.0/2.0 Gigabit Ethernet Network Adapter
Драйвер: Компиляция и Настройка на Linux

===============================================================================

================
Предварительные условия

Чтобы скомпилировать драйвер, вам необходимо установить исходные коды ядра Linux на
машине сборки и убедиться, что версия запущенного ядра совпадает с версией
установленных исходных кодов ядра. Если у вас нет исходных кодов ядра, вы можете
получить их на сайте www.kernel.org или обратиться к дистрибутору Linux. Если вы не
знаете, как это сделать, обратитесь к KERNEL-HOWTO.

Примечание: Убедитесь, что ядро собрано с одним из вариантов
поддержки "Поддержка для хост-стороны, XHCI, EHCI, OHCI или UHCI".

================
Начало работы

Распакуйте сжатый исходный файл драйвера в ваш временный каталог с помощью
следующей команды:
$tar -xf DRIVER_SOURCE_PACKAGE.tar.bz2

Теперь исходные файлы драйвера должны быть распакованы в текущий каталог.
Выполните следующую команду для компиляции драйвера:
$make

Если компиляция завершилась успешно, файл ax_usb_nic.ko будет создан в
текущем каталоге.

================
Использование

=== Установка драйвера в систему

Если вы хотите использовать команду modprobe для монтирования драйвера,
выполните следующую команду, чтобы установить драйвер в систему:
$sudo make install
Примечание: Эта команда создаст резервную копию встроенного драйвера
ax88179_178a, если он существует.

Если вы хотите загрузить драйвер с помощью команды modprobe, выполните
следующие команды:
$sudo modprobe ax_usb_nic

Если вы хотите выгрузить драйвер с помощью команды modprobe, выполните
следующие команды:
$sudo modprobe -r ax_usb_nic

Если вы хотите проверить информацию о драйвере, выполните следующие команды:
$modinfo ax_usb_nic

=== Установка драйвера вручную

Если вы хотите загрузить драйвер вручную, перейдите в каталог драйвера и
выполните следующие команды:
$sudo modprobe mii
$sudo insmod ax_usb_nic.ko

Если вы хотите выгрузить драйвер, просто выполните следующую команду:
$sudo rmmod ax_usb_nic

Если вы хотите проверить информацию о драйвере, выполните следующие команды:
$modinfo ax_usb_nic.ko

================
Программирование и тестирование IEEE

ASIX USB Ethernet Linux командная строка программирования

[Примечание]: Включение сообщения DEBUG

Измените ENABLE_IOCTL_DEBUG на y в файле Makefile.
ENABLE_IOCTL_DEBUG = n
->
ENABLE_IOCTL_DEBUG = y

Распакуйте сжатый исходный файл драйвера в ваш временный каталог с помощью
следующей команды:
$tar -xf DRIVER_SOURCE_PACKAGE.tar.bz2

Теперь исходные файлы драйвера должны быть распакованы в текущий каталог.
Выполните следующую команду, чтобы скомпилировать драйвер:
$make

Загрузите драйвер вручную, перейдите в каталог драйвера и выполните
следующие команды:
$sudo modprobe mii
$sudo insmod ax_usb_nic.ko

Если компиляция прошла успешно, ioctl будет создан в текущем каталоге.

Примечание: По умолчанию для поиска интерфейса используется сканирование
устройства ASIX с использованием ethx (x: 0~255). Это определяется в файле
command.h.
(Как показано ниже)
...
// DEFAULT_SCAN : scan "eth0" - "eth255"
// INTERFACE_SCAN : scan all available network interfaces
#define NET_INTERFACE DEFAULT_SCAN
#define DEFAULT_SCAN 0x00
#define INTERFACE_SCAN 0x01
...
Настройте содержимое #define NET_INTERFACE для выбора нужного метода.

================
Включение PTP (Precision Time Protocol)

Если вы хотите включить функцию PTP, измените ENABLE_PTP_FUNC на 'y' в
файле makefile, а затем перекомпилируйте его.

ENABLE_PTP_FUNC = n
->
ENABLE_PTP_FUNC = y

=== AX88179/178A Программист EEPROM/eFuse

Если вы хотите выгрузить значения из EEPROM/EFUSE в файл, перейдите в
каталог драйвера и выполните следующую команду:
$sudo ./ax88179_programmer reeprom 0 eeprom 512
$sudo ./ax88179_programmer reeprom 1 efuse 64

Если вы хотите записать значения из файла в EEPROM/EFUSE, перейдите в
каталог драйвера и выполните следующую команду:
$sudo ./ax88179_programmer weeprom 0 eeprom 512
$sudo ./ax88179_programmer weeprom 1 efuse 64

Если вы хотите изменить MAC-адрес ключа, перейдите в каталог драйвера и
выполните следующую команду:
$sudo ./ax88179_programmer chgmac 0 mac_addr 512
$sudo ./ax88179_programmer chgmac 1 mac_addr 64

Если вам нужна дополнительная информация об инструкциях, перейдите в
каталог драйвера и выполните следующие команды:
$sudo ./ax88179_programmer reeprom help
$sudo ./ax88179_programmer weeprom help
$sudo ./ax88179_programmer chgmac help

=== AX88179B/179A/772E/772D Программист Flash/eFuse

Если вы хотите получить справку по конкретной команде, перейдите в каталог
драйвера и выполните следующую команду:
$sudo ./ax88179b_179a_772e_772d_programmer help [command]

Если вы хотите получить версию прошивки, перейдите в каталог драйвера и
выполните следующую команду:
$sudo ./ax88179b_179a_772e_772d_programmer rversion

Если вы хотите получить MAC-адрес, перейдите в каталог драйвера и
выполните следующую команду:
$sudo ./ax88179b_179a_772e_772d_programmer rmacaddr

Если вы хотите записать значения из файла во флэш-память, перейдите в
каталог драйвера и выполните следующую команду:
$sudo ./ax88179b_179a_772e_772d_programmer wflash [file]

Если вы хотите записать eFuse, перейдите в каталог драйвера и выполните
следующую команду:
$sudo ./ax88179b_179a_772e_772d_programmer wefuse -m [MAC] -s [SN] -f [File]
--led0 [value] --led1 [value] -p [device]
-m [MAC] - MAC-адрес (XX:XX:XX:XX:XX:XX)
-s [SN] - Серийный номер
-f [File] - Путь к файлу eFuse
--led0 [value] - значение: control_blink (XXXX_XXXX)
--led1 [value] - значение: control_blink (XXXX_XXXX)
-p [device] - устройство: "AX88179B" или "AX88179A" или "AX88772E" или "AX88772D"
Пример:
$sudo ./ax88179b_179a_772e_772d_programmer wefuse -m 00:0E:C6:81:79:01
-s 00000000000001 -f eFuse_Dump.txt

$sudo ./ax88179b_179a_772e_772d_programmer wefuse -m 00:0E:C6:81:79:01
 -s 0000000000179A --led0 8007_0000 --led1 8000_003F -p AX88179A

 $sudo ./ax88179b_179a_772e_772d_programmer wefuse -m 00:0E:C6:87:72:D1
 -s 0000000000772D -p AX88772D
content_copy
Используйте код с осторожностью.

Если вы хотите прочитать eFuse, перейдите в каталог драйвера и выполните
следующую команду:
$sudo ./ax88179b_179a_772e_772d_programmer refuse -f [File]

Если вы хотите перезагрузить флэш-память или eFuse, чтобы проверить версию
или MAC-адрес и т. д., перейдите в каталог драйвера и выполните следующую
команду:
$sudo ./ax88179b_179a_772e_772d_programmer reload

=== AX88179B/179A/772E/772D Тестовый инструмент IEEE

Если вы хотите выполнить тест IEEE, перейдите в каталог драйвера и
выполните следующую команду:

$sudo ./ax88179b_179a_772e_772d_ieee ieeetest speed option
-- AX88179B_179A_772E_772D Тестовый инструмент IEEE
[speed] - 1000: 1000 Мбит/с, 100: 100 Мбит/с, 10: 10 Мбит/с
[option] - Для 1000 Мбит/с
M1: Режим 1
M2: Режим 2
M3: Режим 3
M4: Режим 4

- Для 100 Мбит/с
 		CA: Канал A
 		CB: Канал B

 	   - Для 10 Мбит/с
 		RP: Случайный шаблон
 		FF: Фиксированный шаблон (FF)
 		MDI: MDI
content_copy
Используйте код с осторожностью.

=== AX88279 Linux Инструмент программирования Flash

Если вы хотите получить справку по конкретной команде, перейдите в каталог
драйвера и выполните следующую команду:
$sudo ./ax88279_programmer help [command]

Если вы хотите получить версию прошивки, перейдите в каталог драйвера и
выполните следующую команду:
$sudo ./ax88279_programmer rversion

Если вы хотите получить MAC-адрес, перейдите в каталог драйвера и
выполните следующую команду:
$sudo ./ax88279_programmer rmacaddr

Если вы хотите записать значения из файла во флэш-память, перейдите в
каталог драйвера и выполните следующую команду:
$sudo ./ax88279_programmer wflash [file]

Если вы хотите записать параметр во флэш-память, перейдите в каталог
драйвера и выполните следующую команду:
$sudo ./ax88279_programmer wpara -m [MAC] -s [SN] -p [PID] -v [VID] -P [PS] -M [MN] -D [dump]
-S [SS] -H [HS] -w [wol] -l [led0 value] -e [led1 value] -d [led2 value]
-m [MAC] - MAC-адрес (XX:XX:XX:XX:XX:XX) X:'0'-'F'
-s [SN] - Серийный номер (Количество символов должно быть менее 19 байт) X:'0'-'F'
-p [PID] - Идентификатор продукта (XX:XX) X:'0'-'F'
-v [VID] - Идентификатор поставщика (XX:XX) X:'0'-'F'
-P [PS] - Строка продукта (Количество символов должно быть менее 19 байт)
-M [MN] - Название производителя (Количество символов должно быть менее 19 байт)
-D [dump] - Содержимое параметра, которое в настоящее время находится во флэш-памяти (dump)
-S [SS] - Мощность шины SS (XX) X:0-896
-H [HS] - Мощность шины HS (XX) X:0-500
-w [wol] - Пробуждение по сети (XXXXXXXX) X:цифра
-l [led0 value] - значение: control_blink (XXXX_XXXX)
-e [led1 value] - значение: control_blink (XXXX_XXXX)
Пример:
$sudo ./ax88279_programmer wpara -m 00:0e:c6:81:79:01 -s 00000000000001

$sudo ./ax88279_programmer wpara -p 17:90 -v 0b:95 -P ax88279 -M asix

 $sudo ./ax88279_programmer wpara -S 400 -H 200 -w 21426543

 $sudo ./ax88279_programmer wpara -l C113_0004 -e C002_0C4F
content_copy
Используйте код с осторожностью.

Если вы хотите просмотреть текущее содержимое параметра во флэш-памяти,
перейдите в каталог драйвера и выполните следующую команду. Вы увидите файл
parameter.txt в каталоге драйвера:
$sudo ./ax88279_programmer wpara -D dump

Если вы хотите перезагрузить флэш-память, чтобы проверить версию или
MAC-адрес и т. д., перейдите в каталог драйвера и выполните следующую команду:
$sudo ./ax88279_programmer reload